# UI Behavior Test Matrix (WhatsApp)

| transition_id | flow | screen | trigger | from_state | to_state | expected next state image | acceptance check | open question / risk |
| --- | --- | --- | --- | --- | --- | --- | --- | --- |
| `wa_gateway_initial_view` | whatsapp-setup | messaging | `system:open-messaging-settings` | `none` | `gateway_default` | `images/web/whatsapp-setup/whatsapp-setup-gateway-default.png` | Gateway step is active and `Validate Connection` is visible. | Should default URL be prefilled from persisted config? |
| `wa_gateway_validate_loading` | whatsapp-setup | messaging | `click:validate-connection` | `gateway_default` | `gateway_loading` | `images/web/whatsapp-setup/whatsapp-setup-gateway-loading.png` | Button enters loading and health check message appears. | Need debounce on repeated clicks. |
| `wa_gateway_validate_ready` | whatsapp-setup | messaging | `system:gateway-health-ready` | `gateway_loading` | `gateway_ready` | `images/web/whatsapp-setup/whatsapp-setup-gateway-ready.png` | Gateway marked complete and Session becomes active. | Show/hide endpoint latency details policy. |
| `wa_session_start_pending_qr` | whatsapp-setup | messaging | `click:start-session` | `gateway_ready` | `session_pending_qr` | `images/web/whatsapp-setup/whatsapp-setup-session-pending-qr.png` | Session panel shows `PENDING_QR` and QR-not-ready guidance. | Should Start button remain primary while pending? |
| `wa_session_qr_available` | whatsapp-setup | messaging | `click:refresh-qr` | `session_pending_qr` | `session_qr_visible` | `images/web/whatsapp-setup/whatsapp-setup-session-qr-visible.png` | QR panel renders with scan instruction. | QR expiration countdown display not represented. |
| `wa_session_status_active` | whatsapp-setup | messaging | `system:session-active` | `session_pending_qr` | `session_active` | `images/web/whatsapp-setup/whatsapp-setup-session-active.png` | Session summary shows `ACTIVE` and binding step becomes active. | Need behavior if status regresses to `DEGRADED`. |
| `wa_binding_enter_empty` | whatsapp-setup | messaging | `system:binding-step-open` | `session_active` | `binding_empty` | `images/web/whatsapp-setup/whatsapp-setup-binding-empty.png` | Empty binding state is explicit and Save is available. | Target options empty/runtime-off messaging can vary. |
| `wa_binding_save_success` | whatsapp-setup | messaging | `click:save-binding` | `binding_empty` | `binding_saved` | `images/web/whatsapp-setup/whatsapp-setup-binding-saved.png` | Green success banner + saved binding row appear. | Need stale-selection failure variant image. |
| `wa_verification_run_loading` | whatsapp-setup | messaging | `click:run-verification` | `binding_saved` | `verification_loading` | `images/web/whatsapp-setup/whatsapp-setup-verification-loading.png` | Verification checklist shows running state. | Copy quality in generated image needs final cleanup if product-facing. |
| `wa_verification_blocked` | whatsapp-setup | messaging | `system:verification-blocked` | `verification_loading` | `verification_error` | `images/web/whatsapp-setup/whatsapp-setup-verification-error.png` | Blocked error includes remediation buttons. | Multiple blocker aggregation not visualized. |
| `wa_verification_ready` | whatsapp-setup | messaging | `system:verification-ready` | `verification_loading` | `ready` | `images/web/whatsapp-setup/whatsapp-setup-ready.png` | Ready state shows recap + next actions. | Verify icon styling should be standardized. |
